{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst apiKey = '54728905-47b91fba438408292028d34aa';\nexport default async function getImagesByQuery(query, page) {\n  const response = await axios.get('', {\n    params: {\n      key: apiKey,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page,\n    },\n  });\n  return response.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst lb = new SimpleLightbox('.gallery-link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  navText: [\n    `<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"#000\" xmlns=\"http://www.w3.org/2000/svg\">\n  <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M17.031 2.469C17.1008 2.53867 17.1563 2.62143 17.1941 2.71255C17.2319 2.80367 17.2513 2.90135 17.2513 3C17.2513 3.09865 17.2319 3.19633 17.1941 3.28745C17.1563 3.37857 17.1008 3.46133 17.031 3.531L8.5605 12L17.031 20.469C17.1718 20.6098 17.2509 20.8008 17.2509 21C17.2509 21.1992 17.1718 21.3902 17.031 21.531C16.8902 21.6718 16.6992 21.7509 16.5 21.7509C16.3008 21.7509 16.1098 21.6718 15.969 21.531L6.969 12.531C6.89915 12.4613 6.84374 12.3786 6.80593 12.2874C6.76812 12.1963 6.74866 12.0986 6.74866 12C6.74866 11.9013 6.76812 11.8037 6.80593 11.7125C6.84374 11.6214 6.89915 11.5387 6.969 11.469L15.969 2.469C16.0387 2.39915 16.1214 2.34374 16.2125 2.30593C16.3037 2.26812 16.4013 2.24866 16.5 2.24866C16.5986 2.24866 16.6963 2.26812 16.7874 2.30593C16.8786 2.34374 16.9613 2.39915 17.031 2.469Z\" fill=\"black\" />\n</svg>`,\n    `<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"#000\" xmlns=\"http://www.w3.org/2000/svg\">\n  <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M6.96912 2.469C7.03879 2.39915 7.12155 2.34374 7.21267 2.30593C7.30379 2.26812 7.40147 2.24866 7.50012 2.24866C7.59877 2.24866 7.69645 2.26812 7.78757 2.30593C7.87869 2.34374 7.96145 2.39915 8.03112 2.469L17.0311 11.469C17.101 11.5387 17.1564 11.6214 17.1942 11.7125C17.232 11.8037 17.2515 11.9013 17.2515 12C17.2515 12.0986 17.232 12.1963 17.1942 12.2874C17.1564 12.3786 17.101 12.4613 17.0311 12.531L8.03112 21.531C7.89029 21.6718 7.69928 21.7509 7.50012 21.7509C7.30096 21.7509 7.10995 21.6718 6.96912 21.531C6.82829 21.3902 6.74917 21.1992 6.74917 21C6.74917 20.8008 6.82829 20.6098 6.96912 20.469L15.4396 12L6.96912 3.531C6.89927 3.46133 6.84386 3.37857 6.80605 3.28745C6.76824 3.19633 6.74878 3.09865 6.74878 3C6.74878 2.90135 6.76824 2.80367 6.80605 2.71255C6.84386 2.62143 6.89927 2.53867 6.96912 2.469Z\" fill=\"black\" />\n</svg>`,\n  ],\n  closeText: `<svg width=\"14\" height=\"14\" viewBox=\"0 0 14 14\" fill=\"#000\" xmlns=\"http://www.w3.org/2000/svg\">\n  <path d=\"M0.293787 0.293787C0.386678 0.200661 0.497029 0.126775 0.61852 0.0763616C0.74001 0.0259488 0.870253 0 1.00179 0C1.13332 0 1.26356 0.0259488 1.38505 0.0763616C1.50654 0.126775 1.6169 0.200661 1.70979 0.293787L7.00179 5.58779L12.2938 0.293787C12.3868 0.200811 12.4971 0.127058 12.6186 0.0767403C12.7401 0.0264221 12.8703 0.000523567 13.0018 0.000523567C13.1333 0.000523567 13.2635 0.0264221 13.385 0.0767403C13.5064 0.127058 13.6168 0.200811 13.7098 0.293787C13.8028 0.386763 13.8765 0.497141 13.9268 0.61862C13.9772 0.740099 14.003 0.870299 14.003 1.00179C14.003 1.13327 13.9772 1.26348 13.9268 1.38495C13.8765 1.50643 13.8028 1.61681 13.7098 1.70979L8.41579 7.00179L13.7098 12.2938C13.8028 12.3868 13.8765 12.4971 13.9268 12.6186C13.9772 12.7401 14.003 12.8703 14.003 13.0018C14.003 13.1333 13.9772 13.2635 13.9268 13.385C13.8765 13.5064 13.8028 13.6168 13.7098 13.7098C13.6168 13.8028 13.5064 13.8765 13.385 13.9268C13.2635 13.9772 13.1333 14.003 13.0018 14.003C12.8703 14.003 12.7401 13.9772 12.6186 13.9268C12.4971 13.8765 12.3868 13.8028 12.2938 13.7098L7.00179 8.41579L1.70979 13.7098C1.61681 13.8028 1.50643 13.8765 1.38495 13.9268C1.26348 13.9772 1.13327 14.003 1.00179 14.003C0.870299 14.003 0.740099 13.9772 0.61862 13.9268C0.497141 13.8765 0.386763 13.8028 0.293787 13.7098C0.200811 13.6168 0.127058 13.5064 0.0767403 13.385C0.0264221 13.2635 0.000523567 13.1333 0.000523567 13.0018C0.000523567 12.8703 0.0264221 12.7401 0.0767403 12.6186C0.127058 12.4971 0.200811 12.3868 0.293787 12.2938L5.58779 7.00179L0.293787 1.70979C0.200661 1.6169 0.126775 1.50654 0.0763616 1.38505C0.0259488 1.26356 0 1.13332 0 1.00179C0 0.870253 0.0259488 0.74001 0.0763616 0.61852C0.126775 0.497029 0.200661 0.386678 0.293787 0.293787Z\" fill=\"black\" />\n</svg>`,\n});\nconst loadButton = document.querySelector('.load-more');\nexport function createGallery(images) {\n  const items = images\n    .map(\n      ({\n        webformatURL = '',\n        largeImageURL = '',\n        tags = '',\n        likes = '0',\n        views = '0',\n        comments = '0',\n        downloads = '0',\n      }) => {\n        if (webformatURL.trim() != '' && largeImageURL.trim() != '') {\n          return `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${webformatURL}\"\n      data-source=\"${largeImageURL}\"\n      alt=\"${tags}\"\n      width=\"360\" height=\"200\"\n    />\n    <ul class=\"gallery-additional-info\">\n    <li class=\"additional-info-text\"><span class=\"additional-info-label\">Likes</span>\n    <span class=\"additional-info-value\">${likes}</span></li>\n    <li class=\"additional-info-text\"><span class=\"additional-info-label\">Views</span>\n    <span class=\"additional-info-value\">${views}</span></li>\n    <li class=\"additional-info-text\"><span class=\"additional-info-label\">Comments</span>\n    <span class=\"additional-info-value\">${comments}</span></li>\n    <li class=\"additional-info-text\"><span class=\"additional-info-label\">Downloads</span>\n    <span class=\"additional-info-value\">${downloads}</span></li>\n    </ul>\n  </a>\n</li>`;\n        }\n      }\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', items);\n  updateLightBox();\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  loader.classList.remove('is-hidden');\n}\n\nexport function hideLoader() {\n  loader.classList.add('is-hidden');\n}\n\nexport function updateLightBox() {\n  lb.refresh();\n}\n\nexport function showLoadButton() {\n  loadButton.classList.remove('is-hidden');\n}\nexport function hideLoadButton() {\n  loadButton.classList.add('is-hidden');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport getImagesByQuery from './js/pixabay-api';\nimport {\n  gallery,\n  clearGallery,\n  createGallery,\n  showLoader,\n  hideLoader,\n  hideLoadButton,\n  showLoadButton,\n} from './js/render-functions';\n\nfunction handleErrorMessage(message = 'Something went wrong') {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n    position: 'topRight',\n    theme: 'dark',\n    icon: '',\n    iconUrl: '../img/error.svg',\n    backgroundColor: '#ef4040',\n  });\n}\n\nasync function loadButtonHandler() {\n  let query = sessionStorage.getItem('search-text');\n  hideLoadButton();\n  showLoader();\n  current_page += 1;\n  if (!query) {\n    hideLoader();\n    return;\n  }\n  try {\n    let res = await getImagesByQuery(query, current_page);\n    if (res.hits.length === 0) {\n      Promise.reject(\n        new Error(\n          'Sorry, there are no images matching your search query. Please try again!'\n        )\n      );\n    }\n    createGallery(res.hits);\n  } catch (error) {\n    handleErrorMessage(error.message);\n  } finally {\n    hideLoader();\n  }\n  if (current_page >= total_pages) {\n    handleErrorMessage(\n      `We're sorry, but you've reached the end of search results.`\n    );\n    return;\n  }\n  showLoadButton();\n}\n\nconst form = document.querySelector('.form');\nconst more_button = document.querySelector('.load-more');\nlet current_page = 1;\nlet total_pages = 0;\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n  const query = form.elements['search-text'].value.toLowerCase().trim();\n  if (!query) return;\n  sessionStorage.setItem('search-text', query);\n  clearGallery();\n  showLoader();\n  current_page = 1;\n  try {\n    let res = await getImagesByQuery(query, current_page);\n    if (res.hits.length === 0) {\n      return Promise.reject(\n        new Error(\n          'Sorry, there are no images matching your search query. Please try again!'\n        )\n      );\n    }\n    total_pages = Math.ceil(res.totalHits / 15);\n    createGallery(res.hits);\n    if (total_pages == current_page) {\n      handleErrorMessage(\n        `We're sorry, but you've reached the end of search results.`\n      );\n      hideLoadButton();\n    } else {\n      showLoadButton();\n    }\n  } catch (error) {\n    handleErrorMessage(error.message);\n  } finally {\n    hideLoader();\n  }\n});\nmore_button.addEventListener('click', loadButtonHandler);\n"],"names":["axios","apiKey","getImagesByQuery","query","page","gallery","loader","lb","SimpleLightbox","loadButton","createGallery","images","items","webformatURL","largeImageURL","tags","likes","views","comments","downloads","updateLightBox","clearGallery","showLoader","hideLoader","showLoadButton","hideLoadButton","handleErrorMessage","message","iziToast","loadButtonHandler","current_page","res","error","total_pages","form","more_button","event"],"mappings":"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"}